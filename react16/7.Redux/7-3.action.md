# Action

1. action是一个plain-object（平面对象）
   1. 它的__proto__指向Object.prototype

2. 通常，使用payload属性表示附加数据（没有强制要求）

3. **action中必须有type属性**，该属性用于描述操作的类型

   1. 但是，没有对type的类型做出要求

4. 在大型项目，由于操作类型非常多，为了避免硬编码（hard code），会将action的类型存放到一个或一些单独的文件中(样板代码)。

   ```js
   // action-types.js
   
   export const INCREASE = Symbol('increase');
   export const DECREASE = Symbol('decrease');
   export const SET = Symbol('set');
   ```

5. 为了方便传递action，通常会使用action创建函数(action creator)来创建action
   1. action创建函数应为无副作用的纯函数
      1. 不能以任何形式改动参数
      2. 不可以有异步
      3. 不可以对外部环境中的数据造成影响

   ```js
   // number-action.js
   
   import * as actionTypes from './action-types';
   
   export function createIncreaseAction() {
     return {
       type: actionTypes.INCREASE,
     };
   }
   export function createDecreaseAction() {
     return {
       type: actionTypes.DECREASE,
     };
   }
   export function createSetAction(n) {
     return {
       type: actionTypes.SET,
       payload: n,
     };
   }
   ```

6. 为了方便利用action创建函数来分发（触发）action，redux提供了一个函数```bindActionCreators```，该函数用于增强action创建函数的功能，使它不仅可以创建action，并且创建后会自动完成分发。

   **使用**

   ```js
   // 第一个参数，是action创建函数合并的对象，第二个参数是仓库的dispatch函数
   // 得到一个新的对象，新对象中的属性名与第一个参数的属性名一致
   // 调用新对象中的action创建函数 它不仅可以创建action，并且创建后会自动完成分发。
   const bindActionTypes = bindActionCreators(numberActions, store.dispatch);
   ```

   ## 7-2.redux管理数据 更新

   ```js
   import { createStore, bindActionCreators } from 'redux';
   import * as actionTypes from './action/action-types';
   import * as numberActions from './action/number-actions';
   //约定 仓库仅存放一个数字 7
   // action 格式：{type:"操作类型"，payload:附加信息}
   
   /**
    *
    * @param {*} state 仓库中旧的状态
    * @param {*} action 普通对象，描述了行为
    */
   function reducer(state, action) {
     if (action.type === actionTypes.INCREASE) {
       return state + 1;
     } else if (action.type === actionTypes.DECREASE) {
       return state - 1;
     } else if (action.type === actionTypes.SET) {
       return action.payload;
     } else {
       return state; //无效的操作类型保持旧数据
     }
   }
   
   //创建一个仓库
   //传入reducer使仓库持有该reducer引用 并给仓库数据赋以初值7
   const store = createStore(reducer, 7);
   
   //创建一个action
   // const action = {
   //   type: actionTypes.INCREASE,
   // };
   console.log(store.getState()); //store.getState()获取仓库数据
   
   const bindActionTypes = bindActionCreators(numberActions, store.dispatch);
   
   // store.dispatch(numberActions.createIncreaseAction()); //分发一个action
   bindActionTypes.createIncreaseAction();
   
   console.log(store.getState()); //store.getState()获取仓库数据
   
   // store.dispatch(numberActions.createSetAction(3)); //分发一个action
   bindActionTypes.createSetAction(3);
   
   console.log(store.getState()); //store.getState()获取仓库数据
   ```

   