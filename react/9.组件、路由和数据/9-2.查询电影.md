# 查询电影

**处理方式：**

- mapStateToProps、mapDispatchToProps 书写成一个变量 便与重新赋值

```js
import React from 'react';
import { connect } from 'react-redux';
import MovieSearchBar from './components/MovieSearchBar';
import MovieTable from './components/MovieTable';
import Pager from './components/common/Pager';
import Loading from './components/Loading';
import { searchConditionChange } from './store/action/movieInfo/searchCondition';
import { fetchMovieInfo } from './store/action/movieInfo/searchResult';
import store from './store';

let mapStateToProps = (state) => ({
  searchOptions: {
    page: state.movieInfo.condition.page,
    limit: state.movieInfo.condition.limit,
  },
});

let mapDispatchToProps = (dispatch) => ({
  onSearchOptionsChange(newCondition) {
    dispatch(searchConditionChange(newCondition));
    dispatch(fetchMovieInfo());
  },
});

const SearchBar = connect(mapStateToProps, mapDispatchToProps)(MovieSearchBar);

mapStateToProps = (state) => ({
  movieList: state.movieInfo.result.movieList,
});

const Table = connect(mapStateToProps)(MovieTable);

mapStateToProps = (state) => ({
  currentPage: state.movieInfo.condition.page,
  total: state.movieInfo.result.movieTotal,
  limit: state.movieInfo.condition.limit,
  showPageNums: 7,
});

mapDispatchToProps = (dispatch) => ({
  pageChange(newPage) {
    dispatch(searchConditionChange({ page: newPage }));
    dispatch(fetchMovieInfo());
  },
});

const MoviePager = connect(mapStateToProps, mapDispatchToProps)(Pager);

mapStateToProps = (state) => ({
  isLoading: state.movieInfo.result.isLoading,
});

const MovieLoading = connect(mapStateToProps)(Loading);

export default class MoviePage extends React.Component {
  componentDidMount() {
    store.dispatch(fetchMovieInfo());
  }

  render() {
    return (
      <>
        <SearchBar />
        <Table />
        <MoviePager />
        <MovieLoading />
      </>
    );
  }
}
```

