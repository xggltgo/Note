# redux-actions

> 该库用于简化action-types、action-creator以及reducer
>
> 注意：在搭配redux-saga中间件使用时，需要利用action creator（action创建函数）.toString()方法来得到action的类型，以供redux-saga中的take、takeEvery等监听action类型使用（好像直接写action创建函数也行，因为重写了toString方法）
>
> 官网文档：https://redux-actions.js.org/



## createAction(s)

### createAction

[createAction](https://redux-actions.js.org/api/createaction#createaction)

该函数用于帮助你创建一个action创建函数（action creator）

```js
import { createAction } from 'redux-actions';

createAction(
  type, //action的类型
  payloadCreator = Identity, //payload创建函数
  ?metaCreator //元数据创建函数(当前用户、登录状态)
)
```

**EXAMPLE**

```js
import { createAction } from 'redux-actions';

const updateAdminUser = createAction(
  'UPDATE_ADMIN_USER',
  updates => updates,
  () => ({ admin: true })
);

updateAdminUser({ name: 'Foo' });
// {
//   type: 'UPDATE_ADMIN_USER',
//   payload: { name: 'Foo' },
//   meta: { admin: true },
// }
```

### createActions

[createActions](https://redux-actions.js.org/api/createaction#createactions)

该函数用于帮助你创建多个action创建函数

```js
import { createActions } from 'redux-actions';

createActions(
  actionMap, //对象 action类型为键，值为payload创建函数
  ?...identityActions,
  ?options
)
```

**EXAMPLE**

action的类型（属性名）配置为常量标准格式，对应生成的action创建函数则以action的类型（属性名）的小驼峰方式命名

```js
import { createActions } from 'redux-actions';

const actionCreatorsObject = createActions({
  INCREASE: null,
  DECREASE: null,
  ASYNC_INCREASE: null,
  ASYNC_DECREASE: null,
  ADD: (n) => n,
});


export const { //利用解构具名导出 action创建函数
  increase,
  decrease,
  asyncIncrease,
  asyncDecrease,
  add,
} = actionCreatorsObject;
```



## handleAction(s)

### handleAction

[handleAction](https://redux-actions.js.org/api/handleaction#handleaction)

简化针对单个action类型的reducer处理，当它匹配到对应的action类型后，会执行对应的函数。该函数返回一个reducer

**细节**

`createAction` also returns its `type` when used as type in `handleAction` or `handleActions`.

通过createAction(s)创建的action creator(action创建函数)，如果在`handleAction` or `handleActions`中使用，则会返回对应的action的类型（==本质上是调用了重写后的action创建函数的toString方法==）。**因此，可以把action创建函数作为handleAction(s)的第一个参数，**

**在handleActions中，在使用action创建函数作为属性名（action类型的时候），需要使用属性表达式[action creator]**

```js
import { handleAction } from 'redux-actions';

handleAction(
  type, //action类型
  reducer | reducerMap = Identity, //(state，action)=>{返回新的状态}
  defaultState, //仓库状态默认值
)
```

**EXAMPLE**

```js
import { add } from '../../action/counter';
import { handleAction } from 'redux-actions';

export default handleAction(add, (state, { payload }) => state + payload, 10);
```

### handleActions

简化针对多个action类型的reducre处理

```js
import { handleActions } from 'redux-actions';

handleActions(reducerMap, defaultState);
//reducerMap：配置为一个对象。属性名为action的类型，属性值为（state,action）=> {返回新的状态}
```

**EXAMPLE**

等价代码：

**注意**

在使用action创建函数作为action类型的时候，需要使用属性表达式[action creator]

```js
import { actionTypes } from '../../action/counter';

const initialState = 7;

export default (state = initialState, { type, payload }) => {
  switch (type) {
    case actionTypes.increase:
      return state + 1;
    case actionTypes.decrease:
      return state - 1;
    case actionTypes.add:
      return state + payload;
    default:
      return state;
  }
};
```

```js
import { handleActions } from 'redux-actions';
import { increase, decrease, add } from '../../action/counter';

export default handleActions(
  {
    [increase]: (state) => state + 1,
    [decrease]: (state) => state - 1,
    [add]: (state, { payload }) => state + payload,
  },
  3
);
```

## combineActions

配合createActions和handleActions两个函数，用于处理多个action-type对应同一个reducer处理函数。

[combineActions](https://redux-actions.js.org/api/combineactions#combineactions)

```js
import { combineActions } from 'redux-actions';

combineActions(...types); //参数为action creator
```

**EXAMPLE**

等价代码：

```js
import { createActions, handleActions, combineActions } from 'redux-actions';

export const {
  increase,
  decrease,
  asyncIncrease,
  asyncDecrease,
  autoIncrease,
  stopAutoIncrease,
  add,
} = createActions({
  INCREASE: () => 1,
  DECREASE: () => -1,
  ASYNC_INCREASE: null,
  ASYNC_DECREASE: null,
  AUTO_INCREASE: null,
  STOP_AUTO_INCREASE: null,
  ADD: (n) => n,
});

export default handleActions(
  {
    [increase]: (state) => state + 1,
    [decrease]: (state) => state - 1,
    [add]: (state, { payload }) => state + payload,
  },
  3
);
```

```js
import { createActions, handleActions, combineActions } from 'redux-actions';

export const {
  increase,
  decrease,
  asyncIncrease,
  asyncDecrease,
  autoIncrease,
  stopAutoIncrease,
  add,
} = createActions({
  INCREASE: () => 1,
  DECREASE: () => -1,
  ASYNC_INCREASE: null,
  ASYNC_DECREASE: null,
  AUTO_INCREASE: null,
  STOP_AUTO_INCREASE: null,
  ADD: (n) => n,
});



const a = combineActions(increase, decrease, add);

export default handleActions(
  {
    [a]: (state, { payload }) => state + payload,
  },
  3
);
```

*最终版*

```js
import { createActions, handleActions, combineActions } from 'redux-actions';

export const {
  increase,
  decrease,
  asyncIncrease,
  asyncDecrease,
  autoIncrease,
  stopAutoIncrease,
  add,
} = createActions({
  INCREASE: () => 1,
  DECREASE: () => -1,
  ASYNC_INCREASE: null,
  ASYNC_DECREASE: null,
  AUTO_INCREASE: null,
  STOP_AUTO_INCREASE: null,
  ADD: (n) => n,
});

export default handleActions(
  {
    [combineActions(increase, decrease, add)]: (state, { payload }) =>
      state + payload,
  },
  3
);
```



