# 嵌套路由路径

我们在处理嵌套路由时，应该尽量避免对匹配路径（即`Route`组件的`path`属性等）的硬编码，防止修改顶级路由配置后，子级嵌套路由都需要依次进行修改。

**因此，在处理嵌套路由时，我们优先考虑对路由配置解耦合**

**我们可以从以下两个方面入手：**

## 利用路由信息的 match属性

在路由匹配上父组件后，路由信息会作为参数传递到父组件内部供开发者使用。此时，我们可以利用`match.path`（即`Route`组件匹配父组件的`path`属性）拼接二级路由进行处理，以达到对路由配置的解耦合。

**之后，若父级路由配置进行了修改，二级路由无需再做任何处理**

```js
import React from 'react';
import './index.css';
import { Link, Route } from 'react-router-dom';
import Red from './Red';
import Green from './Green';

export default function AddStudent({match}) {
  return (
    <div className="add-student-container">
      <div>
        <Link to={`${match.path}/red`}>红区</Link>
        <Link
          to={`${match.path}/green`}
          style={{
            marginLeft: 30,
          }}
        >
          绿区
        </Link>
      </div>
      <div className="son">
        <Route path={`${match.path}/red`} component={Red}></Route>
        <Route path={`${match.path}/green`} component={Green}></Route>
      </div>
    </div>
  );
}
```

## 路由配置文件

书写路由配置文件，将路由配置集中到一个`JS`文件中进行处理，以达到对路由配置的解耦合。

**此后，若需要修改路由配置，只需要关注这一个路由配置文件即可**

```js
//最终格式
// export default {
//   addStudent: {
//     root: '/student/add',
//     red: {
//       root: '/student/add/red',
//       pink: '/student/add/red/pink',
//       hotPink: '/student/add/red/hotPink',
//     },
//     green: '/student/add/green',
//   },
// };

const baseConfig = {
  addStudent: {
    root: '/student/add',
    red: {
      root: '/red',
      pink: '/pink',
      hotPink: '/hotPink',
    },
    green: '/green',
  },
  addCourse: {
    root: '/course/add',
    yellow: '/yellow',
  },
  student: '/student',
};

function initRouteConfig(baseConfig) {
  for (const key in baseConfig) {
    handle(baseConfig[key]);
  }
  return baseConfig;
}

function handle(config) {
  if (typeof config === 'string') {
    return config;
  }
  const root = config.root;
  for (const key in config) {
    if (key !== 'root') {
      if (typeof config[key] === 'string') {
        config[key] = root + config[key];
      } else {
        config[key].root = root + config[key].root;
        handle(config[key]);
      }
    }
  }
}

const routeConfig = initRouteConfig(baseConfig);

export default routeConfig
```

**使用**

```js
import React from 'react';
import './index.css';
import { Link, Route } from 'react-router-dom';
import Red from './Red';
import Green from './Green';
import routeConfig from '../../RouteConfig'

export default function AddStudent() {
  return (
    <div className="add-student-container">
      <div>
        <Link to={routeConfig.addStudent.red.root}>红区</Link>
        <Link
          to={routeConfig.addStudent.green}
          style={{
            marginLeft: 30,
          }}
        >
          绿区
        </Link>
      </div>
      <div className="son">
        <Route path={routeConfig.addStudent.red.root} component={Red}></Route>
        <Route path={routeConfig.addStudent.green} component={Green}></Route>
      </div>
    </div>
  );
}
```

