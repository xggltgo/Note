# 滚动条复位

根据用户的操作习惯，我们在切换页面时往往希望滚动条置顶。

**滚动条复位**作为单页应用程序的通病，在React中，需要开发者自行处理。

现提供如下三种思路供开发者处理。



**三种处理方式均采用`window.scrollTo(0, 0);`搭配css样式`scroll-behavior: smooth;`实现**

**如果需要更加精细的控制滚动条的平滑滚动，可以考虑使用JS封装一个滚动条平滑滚动的动画**

## 高阶组件

### 组件封装

利用高阶组件，在生命周期钩子函数函数中调用函数置顶滚动条

```js
// withScroll.js

import React, { Component } from 'react';

export default function withScroll(Comp) {
  return class ScrollWrapper extends Component {
    componentDidMount() {
      window.scrollTo(0, 0); //利用高阶组件，在生命周期钩子函数函数中调用函数置顶滚动条
    }
    render() {
      return <Comp />;
    }
  };
}
```

### 组件使用

导入高阶组件，传入需要处理滚动条的组件，返回一个处理后的新组件，后续直接使用新组件

```js
import React from 'react';
import { BrowserRouter as Router, Route, NavLink } from 'react-router-dom';
import Page1 from './Page1';
import Page2 from './Page2';
import './App.css';
import withScroll from './withScroll';

const Page1WithScroll = withScroll(Page1); //导入高阶组件，传入需要处理滚动条的组件，返回一个处理后的新组件，后续直接使用新组件
const Page2WithScroll = withScroll(Page2);

export default function App() {
  return (
    <Router>
      <div className="container">
        <div className="navlink-container">
          <NavLink to="/page1">Page1</NavLink>
          <NavLink to="/page2">Page2</NavLink>
        </div>
        <div className="route-container">
          <Route path="/page1" component={Page1WithScroll}></Route>
          <Route path="/page2" component={Page2WithScroll}></Route>
        </div>
      </div>
    </Router>
  );
}
```

## 使用useEffect

### 组件封装

利用Effect Hook，传入当前页面路径，路径发生改变（即切换了页面），允许副作用函数，置顶滚动条。

```js
// useScroll.js

import { useEffect } from 'react';

export default function useScroll(pathname) {
  useEffect(() => {
    window.scrollTo(0, 0); //利用Effect Hook，传入当前页面路径，路径发生改变（即切换了页面），允许副作用函数，置顶滚动条。
  }, [pathname]);
}

```

### 组件使用

在需要处理滚动条滚动的页面组件，导入自定义Hook即可，传入当前页面路径作为参数

```js
// Page1.js

import React from 'react';
import useScroll from './useScroll';

export default function Page1(props) {
  useScroll(props.location.pathname)
  return (
    <div className="page1-container">lorem3000</div>
  );
}


// Page2.js

import React from 'react';
import useScroll from './useScroll';

export default function Page2(props) {
  useScroll(props.location.pathname)
  return (
    <div className="page1-container">lorem3000</div>
  );
}
```

## 使用自定义的导航守卫

直接在导航守卫组件`RouteGuard`，监听器钩子函数中,判断页面是否真的由一个页面跳转到另一个页面后，直接调用函数置顶滚动条即可

```js
import React from 'react';
import { Route, NavLink } from 'react-router-dom';
import Page1 from './Page1';
import Page2 from './Page2';
import './App.css';
import RouteGuard from './RouteGuard';

export default function App() {
  return (
    <RouteGuard
      onChange={(prevLocation, nextLocation) => {
        if (prevLocation.pathname !== nextLocation.pathname) {
          window.scrollTo(0, 0); //直接在导航守卫组件`RouteGuard`，监听器钩子函数中,判断页面是否真的由一个页面跳转到另一个页面后，直接调用函数置顶滚动条即可
        }
      }}
    >
      <div className="container">
        <div className="navlink-container">
          <NavLink to="/page1">Page1</NavLink>
          <NavLink to="/page2">Page2</NavLink>
        </div>
        <div className="route-container">
          <Route path="/page1" component={Page1}></Route>
          <Route path="/page2" component={Page2}></Route>
        </div>
      </div>
    </RouteGuard>
  );
}
```

