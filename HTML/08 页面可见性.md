# 页面可见性



## 经典真题



- 页面可见性（*Page Visibility*）*API* 可以有哪些用途？



## 页面可见性介绍



长期以来我们一直缺少一个==判断用户是否正在浏览某个指定标签页==的方法。



用户是否去看别的网站了？他们切换回来了么？



现在，==*HTML5*== 里页面可见性接口就提供给了程序员一个方法，让他们使用 *visibilitychange* 页面事件来判断当前页面可见性的状态，并针对性的执行某些任务。同时还有新的 *document.hidden* 属性可以使用。



==常用的 *API* 如下==：



- [Document.hidden](https://developer.mozilla.org/zh-CN/docs/Web/API/Document/hidden)：这个新出现的`**Document.hidden**` （只读属性）返回布尔值，表示页面是（true）否（false）隐藏。

```js
document.addEventListener("visibilitychange", function() {
  console.log( document.hidden );
  // Modify behavior...
});
```

- [Document.visibilityState](https://developer.mozilla.org/zh-CN/docs/Web/API/Document/visibilityState)：`**Document.visibilityState**` （只读属性）, 返回[`document`](https://developer.mozilla.org/zh-CN/docs/Web/API/Document)的可见性, 即当前可见元素的上下文环境. 由此可以知道当前文档(即为页面)是在背后, 或是不可见的隐藏的标签页，或者(正在)预渲染.可用的值如下：
  - `'visible'` : 此时页面内容至少是部分可见. 即此页面在前景标签页中，并且窗口没有最小化.
  - `'hidden`' : 此时页面对用户不可见. 即文档处于背景标签页或者窗口处于最小化状态，或者操作系统正处于 '锁屏状态' .
  - `'prerender'` : 页面此时正在渲染中, 因此是不可见的 (considered hidden for purposes of `document.hidden`). 文档只能从此状态开始，永远不能从其他值变为此状态.注意: 浏览器支持是可选的.

- [visibilitychange](https://developer.mozilla.org/zh-CN/docs/Web/API/Document/visibilitychange_event) 事件：当其选项卡的内容变得可见或被隐藏时，会在文档上触发 `visibilitychange` (能见度更改)事件。



下面是一个页面可见性的具体示例：



```html
<body>
    <p>页面可见性示例</p>
    <script>
        document.addEventListener("visibilitychange", function () {
            if(document.visibilityState === "hidden"){
                document.title = "小样去哪儿了？快回来"
            }
            if(document.visibilityState === "visible"){
                document.title = "页面可见性示例"
            }
        });
    </script>
</body>
```



> 更多有关页面可见性的内容可以参阅 *MDN*：*https://developer.mozilla.org/zh-CN/docs/Web/API/Page_Visibility_API*



## 真题解答



- 页面可见性（*Page Visibility*）*API* 可以有哪些用途？

>所谓页面可见性，就是==获取当前页面的可见状态==。因为对于用户来讲可以打开好多标签页面来回切换，然而始终只有一个页面处于显示状态。所以我们可以通过页面可见性（*Page Visibility*）*API* 来判断当前页面是显示状态还是隐藏状态。
>
>==常用的 *API*==有三个，*document.hidden* 返回一个布尔值，如果是 *true*，表示页面隐藏，*false* 则表示页面没有隐藏。不同页面之间来回切换，会触发 *visibilitychange* 事件，还有一个 *document.visibilityState*，表示页面所处的状态。
>
>==常见的用途==：
>
>- 网站有图片轮播效果，只有在用户观看轮播的时候，才会自动展示下一张幻灯片。
>- 显示信息仪表盘的应用程序不希望在页面不可见时轮询服务器进行更新。
>- 页面想要检测是否正在渲染，以便可以准确的计算网页浏览量
>- 当设备进入待机模式时，网站想要关闭设备声音（用户按下电源键关闭屏幕）



-*EOF*-

