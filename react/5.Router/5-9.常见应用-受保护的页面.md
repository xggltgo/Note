# 受保护的页面

在一个系统中，通常有一些页面是需要登录后（鉴权）才能进行访问的页面。

由于，这样的需要鉴权的页面可能很多。因此，**我们优先考虑封装一个高阶组件来统一进行处理**。

## 封装组件 ProtectRoute

**该组件在使用层面上与`Route`组件一致**

**此后，如果还有其他需要鉴权的页面，我们只需导入`ProtectRoute`组件替换掉对应的`Route`组件即可**

```js
// ProtectRoute.js
import React from 'react';
import { Route, Redirect } from 'react-router-dom';

export default function ProtectRoute({
  component: Component,
  children,
  render,
  ...rest
}) {
  return (
    <Route
      {...rest}
      render={(value) => {
        if (localStorage.getItem('token')) {
          return <Component />;
        } else {
          return (
            <Redirect
              to={{
                pathname: '/login',
                state: value.location.pathname,
              }}
            />
          );
        }
      }}
    />
  );
}

```

## 高阶组件 withLogined

**使用**

传递一个需要鉴权的组件，返回一个进行过鉴权处理的新组件，将新组件配置到`Route`组件的`component`属性即可

```js
import React from 'react';
import { Redirect } from 'react-router-dom';

export default function withLogined(Comp) {
  return function LoginedWrapper(props) {
    if (localStorage.getItem('token')) {
      return <Comp {...props} />;
    } else {
      return (
        <Redirect
          to={{
            pathname: '/login',
            state: props.location.pathname,
          }}
        />
      );
    }
  };
}
```

