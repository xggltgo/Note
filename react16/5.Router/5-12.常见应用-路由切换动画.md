# 路由切换动画

第三方动画库：react-transition-group

CSSTransition：用于为内部的DOM元素添加类样式，通过in属性决定内部的DOM处于退出还是进入阶段。

我们利用第三方库`react-transition-group`实现路由切换动画时，会遇到一个比较棘手的问题：由于`Route`组件的匹配模式，其`Path`属性匹配成功后才会渲染对应的组件，反之则不进行渲染。

**因此，导致了我们不能成功的向组件加入进入、退出等类样式，也就不能实现动画**

**细节：我们可以利用Route组件的children属性传递成一个函数时，无论是否成功匹配path属性，都会进行渲染这一特性，来实现路由切换动画**

## 封装 TransitionRoute组件

### 组件封装

```js
import React from 'react';
import { Route } from 'react-router-dom';
import { CSSTransition } from 'react-transition-group';
import 'animate.css';

//对Route组件进行进一步的封装 
export default function TransitionRoute(props) {
  const { component: Component, ...rest } = props; //解构出component属性（即path对应的组件） 利用Route组件children属性配置成一个函数 再返回该Component组件 以实现CSSTransition能够添加进入、退出样式等 最终实现路由切换动画
  return (
    <Route {...rest}>
      {({ match }) => {
        return (
          <CSSTransition
            timeout={1000}
            in={match ? true : false} //利用路由信息中的match属性 判断当前是否成功匹配 如果成功匹配则应用进入样式；未成功匹配则应用退出样式
            mountOnEnter //组件进入后才进行挂载
            unmountOnExit //组件退出后进行销毁
            classNames={{
              enterActive: 'animate__fadeInRight',
              exitActive: 'animate__fadeOutLeft',
            }}
          >
            <Component /> 
          </CSSTransition>
        );
      }}
    </Route>
  );
}
```

### 组件使用

说明：直接将`TransitionRoute`组件当作`Route`组件使用即可，路由切换动画已在内部实现

```js
import React from 'react';
import { NavLink, BrowserRouter as Router } from 'react-router-dom';
import Home from './Home';
import News from './News';
import Person from './Person';
import TransitionRoute from './TransitionRoute';
import './App.css';
import 'animate.css';

export default function App() {
  return (
    <Router>
      <div className="container">
        <div className="navlink-container">
          <NavLink to="/" exact>
            Home
          </NavLink>
          <NavLink to="/news" exact>
            News
          </NavLink>
          <NavLink to="/person" exact>
            Person
          </NavLink>
        </div>
        <div className="route-container">
          <TransitionRoute path="/" component={Home} exact></TransitionRoute>
          <TransitionRoute path="/news" component={News}></TransitionRoute>
          <TransitionRoute path="/person" component={Person}></TransitionRoute>
        </div>
      </div>
    </Router>
  );
}
```

