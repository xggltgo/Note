# ImperativeHandle Hook

函数：useImperativeHandleHook

## useImperativeHandle使用

```js
useImperativeHandle(
  first,
  () => {
    second
  },
  [third],
)
```

参数1`first`:通过`React.forwardRef()`转发的ref

参数2`() => {
    second
  }`：一个函数，该函数的返回值会赋值给ref的current属性 `{current:返回值}`

参数3：记录依赖。**如果不给依赖项，则每次运行函数组件都会调用该方法**，如果使用了依赖项，则第一次调用后，会进行缓存，只有依赖项发生变化时才会重新调用函数。

**具体使用**

> 点击按钮，调用函数组`Comp`中通过``useImperativeHandle`缓存的函数

**App.jsx**

```jsx
import React, { useRef } from 'react';
import Comp from './Comp';

const NewComp = React.forwardRef(Comp);

export default function App() {
  const CompRef = useRef();
  return (
    <>
      <NewComp ref={CompRef} />
      <button
        onClick={() => {
          CompRef.current();
        }}
      >
        点击换色
      </button>
    </>
  );
}

```

> 函数组件`Comp`将内部缓存的切换文字颜色功能函数赋值给传递的ref的current属性

```js
import React, { useImperativeHandle, useState } from 'react';

export default function Comp(props, ref) {
  const [color, setColor] = useState('yellow');

  useImperativeHandle(
    ref,
    () => {
      return () => {
        setColor('#ff6370');
      };
    },
    []
  );

  return (
    <div
      style={{
        color,
      }}
    >
      Comp
    </div>
  );
}
```

