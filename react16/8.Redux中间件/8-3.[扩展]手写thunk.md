# 手写 redux-thunk

**核心思想：redux-thunk中间件，如果接收到的action的类型是**

- *函数类型action：执行函数，并不再向后移交该action*
- *plain-object类型action：正常移交*

## bangbangji封装

```js
function createthunkMiddleware(extra) {
  return (store) => (next) => (action) => {
    //该函数返回一个thunk中间件
    if (typeof action === 'function') {
      return action(store.dispatch, store.getState, extra);
    }
    return next(action);
  };
}

const thunk = createthunkMiddleware();
thunk.withExtraArgument = createthunkMiddleware;
export default thunk;
```

## xgglt封装

```js
export default function thunk(store) {
  return function (next) {
    return function (action) {
      if (typeof action === 'function') {
        action(store.dispatch, store.getState, _extra);
      } else {
        next(action);
      }
    };
  };
}

let _extra;

thunk.withExtraArgument = (extra) => {
  _extra = extra;
  return thunk;
};
```

